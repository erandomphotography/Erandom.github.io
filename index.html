<!DOCTYPE html>
<html lang="lv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TALVA - Fotogrāfiju galerija</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Visi stili paliek tie paši kā iepriekš */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        /* ... visi pārējie stili paliek tie paši ... */
        
        /* Paroles aizsardzības logs */
        .password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.85);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .password-modal.active {
            display: flex;
        }
        
        .password-box {
            background-color: white;
            padding: 3rem;
            border-radius: 8px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .password-box h2 {
            margin-bottom: 1.5rem;
            color: #222;
        }
        
        .password-input {
            width: 100%;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 1.1rem;
            transition: border-color 0.3s;
        }
        
        .password-input:focus {
            border-color: #888;
            outline: none;
        }
        
        .password-submit {
            background-color: #333;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.1rem;
            width: 100%;
            transition: background-color 0.3s;
        }
        
        .password-submit:hover {
            background-color: #555;
        }
        
        .password-error {
            color: #d32f2f;
            margin-top: 1rem;
            display: none;
        }
        
        /* Admin panelis */
        .admin-panel {
            background-color: #2a2a2a;
            color: white;
            padding: 1.5rem 2rem;
            display: none;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .admin-panel.active {
            display: flex;
        }
        
        .admin-info {
            font-size: 1.1rem;
        }
        
        .admin-info i {
            margin-right: 8px;
            color: #888;
        }
        
        .logout-btn {
            background-color: #444;
            color: white;
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        .logout-btn:hover {
            background-color: #666;
        }
        
        /* Atjauninātas upload-section klases */
        .upload-section.hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Paroles aizsardzības logs -->
    <div class="password-modal active" id="passwordModal">
        <div class="password-box">
            <h2><i class="fas fa-lock"></i> Administratora piekļuve</h2>
            <p>Lai piekļūtu bilžu augšupielādei, ievadiet administratora paroli:</p>
            <input type="password" class="password-input" id="passwordInput" placeholder="Ievadiet paroli">
            <button class="password-submit" id="passwordSubmit">Piekļūt</button>
            <p class="password-error" id="passwordError">Nepareiza parole. Mēģiniet vēlreiz.</p>
            <p style="margin-top: 1.5rem; font-size: 0.9rem; color: #666;">
                <i class="fas fa-info-circle"></i> Apmeklētāji var tikai skatīt bildes, bet ne augšupielādēt jaunas.
            </p>
        </div>
    </div>
    
    <!-- Admin panelis (rādās tikai pēc pareizas paroles) -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-info">
            <i class="fas fa-user-shield"></i>
            <span>Esi pieslēdzies kā administrators</span>
        </div>
        <button class="logout-btn" id="logoutBtn">
            <i class="fas fa-sign-out-alt"></i> Iziet
        </button>
    </div>

    <!-- Navigācijas josla -->
    <header>
        <div class="nav-container">
            <a href="#" class="logo">TAL<span>VA</span></a>
            <nav>
                <ul>
                    <li><a href="#"><i class="fas fa-home"></i> Blog</a></li>
                    <li><a href="#gallery"><i class="fas fa-images"></i> Galerija</a></li>
                    <li><a href="#contact"><i class="fas fa-envelope"></i> Kontakti</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Galvenā sekcija -->
    <section class="hero">
        <h1>Fotogrāfiju galerija</h1>
        <p>Vieta, kur dalīties ar savām fotografijām melnā, baltā un pelēkā toņos. Spied uz jebkuras bildes, lai to aplūkotu pilnā izmērā.</p>
    </section>

    <!-- Galerijas sekcija -->
    <section class="gallery-section" id="gallery">
        <h2 class="section-title">Mana fotogrāfiju kolekcija</h2>
        <div class="gallery-grid" id="galleryContainer">
            <!-- Bildes tiks ielādētas ar JavaScript -->
        </div>
    </section>

    <!-- Augšupielādes sekcija (sākotnēji paslēpta) -->
    <section class="upload-section hidden" id="uploadSection">
        <h3 class="upload-title">Administratora panelis - bilžu pārvaldība</h3>
        <p>Tikai administrators var pievienot jaunas bildes galerijai. Atbalstītie formāti: JPG, PNG, GIF.</p>
        <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1.5rem; flex-wrap: wrap;">
            <label for="fileInput" class="upload-btn">
                <i class="fas fa-cloud-upload-alt"></i> Izvēlēties bildi
            </label>
            <button class="upload-btn" id="deleteAllBtn" style="background-color: #d32f2f;">
                <i class="fas fa-trash-alt"></i> Dzēst visas bildes
            </button>
        </div>
        <input type="file" id="fileInput" accept="image/*" multiple>
        <p id="uploadStatus"></p>
        <div style="margin-top: 2rem; padding: 1rem; background-color: #f9f9f9; border-radius: 4px;">
            <h4><i class="fas fa-info-circle"></i> Administratora instrukcijas:</h4>
            <ul style="text-align: left; margin-top: 0.5rem;">
                <li>Izvēlieties vienu vai vairākas bildes, lai tās pievienotu galerijai</li>
                <li>Maksimālais faila izmērs: 5 MB</li>
                <li>Ieteicamais izmērs: vismaz 800x600 pikseļi</li>
                <li>Dzēšot visas bildes, tiks atjaunotas sākotnējās bildes</li>
            </ul>
        </div>
    </section>

    <!-- Palielinātās bildes logs -->
    <div class="lightbox" id="lightbox">
        <span class="lightbox-close" id="lightboxClose">&times;</span>
        <div class="lightbox-nav">
            <div class="lightbox-prev" id="lightboxPrev">&#10094;</div>
            <div class="lightbox-next" id="lightboxNext">&#10095;</div>
        </div>
        <img class="lightbox-content" id="lightboxImg">
        <div class="lightbox-caption" id="lightboxCaption"></div>
    </div>

    <!-- Kontaktu sekcija -->
    <section class="contact-section" id="contact">
        <div class="contact-container">
            <h2 class="contact-title">Sazināties ar mani</h2>
            <p>Ja jums ir kādi jautājumi vai vēlaties sadarboties, droši sazinieties!</p>
            <div class="contact-info">
                <div class="contact-item">
                    <i class="fas fa-envelope"></i>
                    <span>info@talva.lv</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-phone"></i>
                    <span>+371 12345678</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Rīga, Latvija</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Kājene -->
    <footer>
        <p>TALVA - Fotogrāfiju galerija</p>
        <p class="copyright">Visas tiesības aizsargātas &copy; <span id="currentYear"></span></p>
    </footer>

    <script>
        // Administratora parole (mainīt pēc vajadzības)
        const ADMIN_PASSWORD = "talva123";
        const SESSION_KEY = "talva_admin_logged_in";
        
        // DOM elementi
        const passwordModal = document.getElementById('passwordModal');
        const passwordInput = document.getElementById('passwordInput');
        const passwordSubmit = document.getElementById('passwordSubmit');
        const passwordError = document.getElementById('passwordError');
        const adminPanel = document.getElementById('adminPanel');
        const logoutBtn = document.getElementById('logoutBtn');
        const uploadSection = document.getElementById('uploadSection');
        const galleryContainer = document.getElementById('galleryContainer');
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightboxImg');
        const lightboxCaption = document.getElementById('lightboxCaption');
        const lightboxClose = document.getElementById('lightboxClose');
        const lightboxPrev = document.getElementById('lightboxPrev');
        const lightboxNext = document.getElementById('lightboxNext');
        const fileInput = document.getElementById('fileInput');
        const uploadStatus = document.getElementById('uploadStatus');
        const deleteAllBtn = document.getElementById('deleteAllBtn');
        
        // Sākotnējās bildes
        const initialImages = [
            { src: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1350&q=80", title: "Kalnu ainava", date: "2023. gada 15. maijs", uploadedBy: "sistēma" },
            { src: "https://images.unsplash.com/photo-1439066615861-d1af74d74000?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1350&q=80", title: "Meža takas", date: "2023. gada 3. jūnijs", uploadedBy: "sistēma" },
            { src: "https://images.unsplash.com/photo-1465146344425-f00d5f5c8f07?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1350&q=80", title: "Pilsētas panorama", date: "2023. gada 22. jūlijs", uploadedBy: "sistēma" }
        ];
        
        let currentImages = JSON.parse(localStorage.getItem('talva_gallery_images')) || [...initialImages];
        let currentImageIndex = 0;
        let isAdminLoggedIn = localStorage.getItem(SESSION_KEY) === 'true';
        
        // Pārbauda, vai lietotājs jau ir pieslēdzies
        function checkLoginStatus() {
            if (isAdminLoggedIn) {
                passwordModal.classList.remove('active');
                adminPanel.classList.add('active');
                uploadSection.classList.remove('hidden');
            } else {
                passwordModal.classList.add('active');
                adminPanel.classList.remove('active');
                uploadSection.classList.add('hidden');
            }
        }
        
        // Pieslēgšanās funkcija
        function login() {
            const password = passwordInput.value.trim();
            
            if (password === ADMIN_PASSWORD) {
                // Veiksmīga pieslēgšanās
                isAdminLoggedIn = true;
                localStorage.setItem(SESSION_KEY, 'true');
                checkLoginStatus();
                passwordInput.value = '';
                passwordError.style.display = 'none';
                
                // Parāda paziņojumu
                showNotification('Veiksmīgi pieslēgts kā administrators!', 'success');
            } else {
                // Nepareiza parole
                passwordError.style.display = 'block';
                passwordInput.value = '';
                passwordInput.focus();
                
                // Vibrācija mobīlajām ierīcēm
                if (navigator.vibrate) {
                    navigator.vibrate(200);
                }
            }
        }
        
        // Atteikšanās funkcija
        function logout() {
            isAdminLoggedIn = false;
            localStorage.setItem(SESSION_KEY, 'false');
            checkLoginStatus();
            showNotification('Veiksmīgi atslēgts no administratora paneļa', 'info');
        }
        
        // Paziņojumu funkcija
        function showNotification(message, type) {
            // Ja jau ir paziņojums, noņem to
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <span>${message}</span>
                <button class="notification-close">&times;</button>
            `;
            
            // Pievieno stilus
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: ${type === 'success' ? '#4caf50' : '#2196f3'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 4px;
                display: flex;
                align-items: center;
                justify-content: space-between;
                min-width: 300px;
                max-width: 400px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 3000;
                animation: slideIn 0.3s ease-out;
            `;
            
            // Pievieno animāciju
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                .notification-close {
                    background: none;
                    border: none;
                    color: white;
                    font-size: 1.5rem;
                    cursor: pointer;
                    margin-left: 1rem;
                }
            `;
            document.head.appendChild(style);
            
            // Pievieno aizvēršanas funkcionalitāti
            const closeBtn = notification.querySelector('.notification-close');
            closeBtn.addEventListener('click', () => {
                notification.remove();
            });
            
            // Automātiski noņem pēc 5 sekundēm
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
            
            document.body.appendChild(notification);
        }
        
        // Galerijas renderēšana
        function renderGallery() {
            galleryContainer.innerHTML = '';
            
            currentImages.forEach((image, index) => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';
                galleryItem.setAttribute('data-index', index);
                
                // Pievieno administratora kontroli, ja ir pieslēdzies
                const adminControls = isAdminLoggedIn ? 
                    `<div class="admin-image-controls">
                        <button class="admin-delete-btn" data-index="${index}" title="Dzēst bildi">
                            <i class="fas fa-trash"></i>
                        </button>
                        <button class="admin-edit-btn" data-index="${index}" title="Rediģēt nosaukumu">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>` : '';
                
                galleryItem.innerHTML = `
                    <img src="${image.src}" alt="${image.title}" class="gallery-img">
                    <div class="img-overlay">
                        <h3 class="img-title">${image.title}</h3>
                        <p class="img-date">${image.date} ${image.uploadedBy === 'sistēma' ? '' : '(augšupielādēja: admins)'}</p>
                    </div>
                    ${adminControls}
                `;
                
                galleryItem.addEventListener('click', (e) => {
                    // Ja klikšķina uz admin kontroles, nevar atvērt lightbox
                    if (!e.target.closest('.admin-image-controls')) {
                        openLightbox(index);
                    }
                });
                
                galleryContainer.appendChild(galleryItem);
            });
            
            // Pievieno admin kontroles notikumus
            if (isAdminLoggedIn) {
                document.querySelectorAll('.admin-delete-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const index = parseInt(btn.getAttribute('data-index'));
                        deleteImage(index);
                    });
                });
                
                document.querySelectorAll('.admin-edit-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const index = parseInt(btn.getAttribute('data-index'));
                        editImageTitle(index);
                    });
                });
            }
            
            // Saglabā bildes localStorage
            localStorage.setItem('talva_gallery_images', JSON.stringify(currentImages));
        }
        
        // Dzēš bildi
        function deleteImage(index) {
            if (confirm('Vai tiešām vēlaties dzēst šo bildi?')) {
                currentImages.splice(index, 1);
                renderGallery();
                showNotification('Bilde veiksmīgi dzēsta', 'success');
            }
        }
        
        // Rediģē bildes nosaukumu
        function editImageTitle(index) {
            const newTitle = prompt('Ievadiet jaunu bildes nosaukumu:', currentImages[index].title);
            if (newTitle && newTitle.trim() !== '') {
                currentImages[index].title = newTitle.trim();
                renderGallery();
                showNotification('Bildes nosaukums atjaunināts', 'success');
            }
        }
        
        // Dzēš visas bildes
        function deleteAllImages() {
            if (confirm('Vai tiešām vēlaties dzēst VISAS bildes? Tiks atjaunotas sākotnējās bildes.')) {
                currentImages = [...initialImages];
                renderGallery();
                showNotification('Visas bildes dzēstas. Atjaunotas sākotnējās bildes.', 'info');
            }
        }
        
        // Lightbox funkcionalitāte (paliek nemainīga)
        function openLightbox(index) {
            currentImageIndex = index;
            updateLightbox();
            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function updateLightbox() {
            const currentImage = currentImages[currentImageIndex];
            lightboxImg.src = currentImage.src;
            lightboxCaption.textContent = `${currentImage.title} - ${currentImage.date}`;
        }
        
        function closeLightbox() {
            lightbox.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function showNextImage() {
            currentImageIndex = (currentImageIndex + 1) % currentImages.length;
            updateLightbox();
        }
        
        function showPrevImage() {
            currentImageIndex = (currentImageIndex - 1 + currentImages.length) % currentImages.length;
            updateLightbox();
        }
        
        // Bilžu augšupielādes apstrāde
        fileInput.addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            
            if (files.length === 0) return;
            
            let uploadedCount = 0;
            let errorCount = 0;
            
            files.forEach((file, fileIndex) => {
                // Pārbauda, vai fails ir attēls
                if (!file.type.match('image.*')) {
                    errorCount++;
                    return;
                }
                
                // Pārbauda faila izmēru (max 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    errorCount++;
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    // Pievieno jauno bildi kolekcijai
                    const newImage = {
                        src: event.target.result,
                        title: `Mana bilde ${currentImages.length + 1}`,
                        date: new Date().toLocaleDateString('lv-LV'),
                        uploadedBy: 'admins'
                    };
                    
                    currentImages.push(newImage);
                    uploadedCount++;
                    
                    // Ja ir pēdējā bilde, atjauno galeriju
                    if (fileIndex === files.length - 1) {
                        renderGallery();
                        
                        let message = `${uploadedCount} bilde(s) veiksmīgi pievienota(s) galerijai!`;
                        if (errorCount > 0) {
                            message += ` ${errorCount} bilde(s) netika pievienota(s) (nederīgs formāts vai pārāk liels izmērs).`;
                        }
                        
                        uploadStatus.textContent = message;
                        uploadStatus.style.color = uploadedCount > 0 ? '#388e3c' : '#d32f2f';
                        
                        // Notīra input lauku
                        fileInput.value = '';
                        
                        // Pazūd statusa paziņojums pēc 5 sekundēm
                        setTimeout(() => {
                            uploadStatus.textContent = '';
                        }, 5000);
                        
                        // Parāda paziņojumu
                        showNotification(message, 'success');
                    }
                };
                
                reader.readAsDataURL(file);
            });
        });
        
        // Pievieno admin kontroles stilus
        const adminStyles = document.createElement('style');
        adminStyles.textContent = `
            .admin-image-controls {
                position: absolute;
                top: 10px;
                right: 10px;
                display: flex;
                gap: 8px;
                z-index: 2;
            }
            
            .admin-delete-btn, .admin-edit-btn {
                background-color: rgba(0,0,0,0.7);
                color: white;
                border: none;
                width: 36px;
                height: 36px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: background-color 0.3s;
            }
            
            .admin-delete-btn:hover {
                background-color: rgba(211, 47, 47, 0.9);
            }
            
            .admin-edit-btn:hover {
                background-color: rgba(33, 150, 243, 0.9);
            }
        `;
        document.head.appendChild(adminStyles);
        
        // Notikumu klausītāji
        passwordSubmit.addEventListener('click', login);
        passwordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                login();
            }
        });
        
        logoutBtn.addEventListener('click', logout);
        deleteAllBtn.addEventListener('click', deleteAllImages);
        
        lightboxClose.addEventListener('click', closeLightbox);
        lightboxNext.addEventListener('click', showNextImage);
        lightboxPrev.addEventListener('click', showPrevImage);
        
        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) {
                closeLightbox();
            }
        });
        
        document.addEventListener('keydown', (e) => {
            if (!lightbox.classList.contains('active')) return;
            
            if (e.key === 'Escape') closeLightbox();
            if (e.key === 'ArrowRight') showNextImage();
            if (e.key === 'ArrowLeft') showPrevImage();
        });
        
        // Uzstāda kājenes gadu
        document.getElementById('currentYear').textContent = new Date().getFullYear();
        
        // Inicializē lapu
        checkLoginStatus();
        renderGallery();
    </script>
</body>
</html>
